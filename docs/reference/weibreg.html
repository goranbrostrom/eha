<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Weibull Regression — weibreg • eha</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Weibull Regression — weibreg" />
<meta property="og:description" content="Proportional hazards model with baseline hazard(s) from the Weibull family
of distributions.  Allows for stratification with different scale and shape
in each stratum, and left truncated and right censored data." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.8.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/eha.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/goranbrostrom/eha/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Weibull Regression</h1>
    <small class="dont-index">Source: <a href='https://github.com/goranbrostrom/eha/blob/master/R/weibreg.R'><code>R/weibreg.R</code></a></small>
    <div class="hidden name"><code>weibreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Proportional hazards model with baseline hazard(s) from the Weibull family
of distributions.  Allows for stratification with different scale and shape
in each stratum, and left truncated and right censored data.</p>
    </div>

    <pre class="usage"><span class='fu'>weibreg</span>(
  <span class='kw'>formula</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/formula.html'>formula</a></span>(<span class='no'>data</span>),
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame</a></span>(),
  <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"na.action"</span>),
  <span class='no'>init</span>,
  <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>eps</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>, <span class='kw'>maxiter</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>),
  <span class='kw'>singular.ok</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>model</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>y</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>center</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a formula object, with the response on the left of a ~
operator, and the terms on the right.  The response must be a survival
object as returned by the Surv function.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a data.frame in which to interpret the variables named in the
formula.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a missing-data filter function, applied to the model.frame,
after any subset argument has been used.  Default is
<code>options()$na.action</code>.</p></td>
    </tr>
    <tr>
      <th>init</th>
      <td><p>vector of initial values of the iteration.  Default initial
value is zero for all variables.</p></td>
    </tr>
    <tr>
      <th>shape</th>
      <td><p>If positive, the shape parameter is fixed at that value (in
each stratum).  If zero or negative, the shape parameter is estimated.  If
more than one stratum is present in data, each stratum gets its own
estimate.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>a list with components <code>eps</code> (convergence criterion),
<code>maxiter</code> (maximum number of iterations), and <code>silent</code> (logical,
controlling amount of output).  You can change any component without mention
the other(s).</p></td>
    </tr>
    <tr>
      <th>singular.ok</th>
      <td><p>Not used.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>Not used.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Return the design matrix in the model object?</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Return the response in the model object?</p></td>
    </tr>
    <tr>
      <th>center</th>
      <td><p>Deprecated, and not used.  Will be removed in the future.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code><a href='https://rdrr.io/r/base/c.html'>c("weibreg", "coxreg")</a></code> with components</p>
<dt>coefficients</dt><dd><p>Fitted parameter estimates.</p></dd> <dt>var</dt><dd><p>Covariance
matrix of the estimates.</p></dd> <dt>loglik</dt><dd><p>Vector of length two; first
component is the value at the initial parameter values, the second componet
is the maximized value.</p></dd> <dt>score</dt><dd><p>The score test statistic (at the
initial value).</p></dd> <dt>linear.predictors</dt><dd><p>The estimated linear predictors.</p></dd>
<dt>means</dt><dd><p>Means of the columns of the design matrix.</p></dd>
<dt>w.means</dt><dd><p>Weighted (against exposure time) means of covariates;
weighted relative frequencies of levels of factors.</p></dd> <dt>n</dt><dd><p>Number of
spells in indata (possibly after removal of cases with NA's).</p></dd>
<dt>events</dt><dd><p>Number of events in data.</p></dd> <dt>terms</dt><dd><p>Used by extractor
functions.</p></dd> <dt>assign</dt><dd><p>Used by extractor functions.</p></dd> %
<dt>wald.test</dt><dd><p>The Wald test statistic (at the initial value).</p></dd>
<dt>y</dt><dd><p>The Surv vector.</p></dd> <dt>isF</dt><dd><p>Logical vector indicating the
covariates that are factors.</p></dd> <dt>covars</dt><dd><p>The covariates.</p></dd>
<dt>ttr</dt><dd><p>Total Time at Risk.</p></dd> <dt>levels</dt><dd><p>List of levels of factors.</p></dd>
<dt>formula</dt><dd><p>The calling formula.</p></dd> <dt>call</dt><dd><p>The call.</p></dd>
<dt>method</dt><dd><p>The method.</p></dd> <dt>convergence</dt><dd><p>Did the optimization
converge?</p></dd> <dt>fail</dt><dd><p>Did the optimization fail? (Is <code>NULL</code> if not).</p></dd>
<dt>pfixed</dt><dd><p>TRUE if shape was fixed in the estimation.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The parameterization is the same as in <code><a href='coxreg.html'>coxreg</a></code> and
<code><a href='https://rdrr.io/pkg/survival/man/coxph.html'>coxph</a></code>, but different from the one used by
<code><a href='https://rdrr.io/pkg/survival/man/survreg.html'>survreg</a></code>. The model is $$h(t; a, b, \beta, z) =
(a/b) (t/b)^{a-1} exp(z\beta)$$ This is in correspondence with <code><a href='Weibull.html'>Weibull</a></code>. To
compare regression coefficients with those from <code>survreg</code> you need to
divide by estimated shape (\(\hat{a}\)) and change sign. The p-values
and test statistics are however the same, with one exception; the score test
is done at maximized scale and shape in <code>weibreg</code>.</p>
<p>This model is a Weibull distribution with shape parameter \(a\) and scale
parameter \(b \exp(-z\beta / a)\)</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function is not maintained, and may behave in unpredictable ways.
Use <code><a href='phreg.html'>phreg</a></code> with <code>dist = "weibull"</code> (the default) instead!
Will soon be declared deprecated.</p>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    <p>The print method <code><a href='print.weibreg.html'>print.weibreg</a></code> doesn't work
if threeway or higher order interactions are present.</p>
<p>Note further that covariates are internally centered, if <code>center =
TRUE</code>, by this function, and this is not corrected for in the output. This
affects the estimate of \(\log(scale)\), but nothing else. If
you don't like this, set <code>center = FALSE</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='phreg.html'>phreg</a></code>, <code><a href='coxreg.html'>coxreg</a></code>,
<code><a href='print.weibreg.html'>print.weibreg</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
 <span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>time</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>, <span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>3</span>),
                <span class='kw'>status</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>),
                <span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>),
                <span class='kw'>sex</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>))
 <span class='fu'>weibreg</span>( <span class='fu'>Surv</span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>x</span> + <span class='fu'>strata</span>(<span class='no'>sex</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>) <span class='co'>#stratified model</span></div><div class='output co'>#&gt; Call:
#&gt; weibreg(formula = Surv(time, status) ~ x + strata(sex), data = dat)
#&gt; 
#&gt; Covariate           Mean       Coef Exp(Coef)  se(Coef)    Wald p
#&gt; x                   0.625     0.590     1.804     0.593     0.320 
#&gt; 
#&gt; log(scale):1                  1.324     3.758     0.312     0.000 
#&gt; log(shape):1                  1.040     2.829     0.496     0.036 
#&gt; log(scale):2                  1.038     2.823     0.190     0.000 
#&gt; log(shape):2                  1.359     3.893     0.570     0.017 
#&gt; 
#&gt; Events                    5 
#&gt; Total time at risk            16 
#&gt; Max. log. likelihood      -7.5616 
#&gt; LR test statistic         0.99 
#&gt; Degrees of freedom        1 
#&gt; Overall p-value           0.318548</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Göran Broström.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


