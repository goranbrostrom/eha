<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Parametric Proportional Hazards Regression — phreg • eha</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Parametric Proportional Hazards Regression — phreg" />
<meta property="og:description" content="Proportional hazards model with parametric baseline hazard(s).  Allows for
stratification with different scale and shape in each stratum, and left
truncated and right censored data." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.8.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/eha.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/goranbrostrom/eha/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Parametric Proportional Hazards Regression</h1>
    <small class="dont-index">Source: <a href='https://github.com/goranbrostrom/eha/blob/master/R/phreg.R'><code>R/phreg.R</code></a></small>
    <div class="hidden name"><code>phreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Proportional hazards model with parametric baseline hazard(s).  Allows for
stratification with different scale and shape in each stratum, and left
truncated and right censored data.</p>
    </div>

    <pre class="usage"><span class='fu'>phreg</span>(
  <span class='kw'>formula</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/formula.html'>formula</a></span>(<span class='no'>data</span>),
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame</a></span>(),
  <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"na.action"</span>),
  <span class='kw'>dist</span> <span class='kw'>=</span> <span class='st'>"weibull"</span>,
  <span class='kw'>cuts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>init</span>,
  <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"canonical"</span>, <span class='st'>"rate"</span>),
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>eps</span> <span class='kw'>=</span> <span class='fl'>1e-08</span>, <span class='kw'>maxiter</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>),
  <span class='kw'>singular.ok</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>model</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>y</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>center</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a formula object, with the response on the left of a ~
operator, and the terms on the right.  The response must be a survival
object as returned by the Surv function.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a data.frame in which to interpret the variables named in the
formula.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a missing-data filter function, applied to the model.frame,
after any subset argument has been used.  Default is
<code>options()$na.action</code>.</p></td>
    </tr>
    <tr>
      <th>dist</th>
      <td><p>Which distribution? Default is "weibull", with the alternatives
"ev" (Extreme value), "gompertz", "pch" (piecewise constant hazards
function), "loglogistic" and "lognormal". A special case like the
<code>exponential</code> can be obtained by choosing "weibull" in combination with
<code>shape = 1</code>, or "pch" without <code>cuts</code>.</p></td>
    </tr>
    <tr>
      <th>cuts</th>
      <td><p>Only used with <code>dist = "pch"</code>. Specifies the points in time
where the hazard function jumps. If omitted, an exponential model is fitted.</p></td>
    </tr>
    <tr>
      <th>init</th>
      <td><p>vector of initial values of the iteration.  Default initial
value is zero for all variables.</p></td>
    </tr>
    <tr>
      <th>shape</th>
      <td><p>If positive, the shape parameter is fixed at that value (in
each stratum).  If zero or negative, the shape parameter is estimated.  If
more than one stratum is present in data, each stratum gets its own
estimate.</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p>Applies only to the Gompertz distribution: "canonical" is
defined in the description of the <code><a href='Gompertz.html'>Gompertz</a></code> distribution;
"rate" transforms <code>scale</code> to 1/log(scale), giving the same
parametrization as in Stata and SAS. The latter thus allows for a negative
rate, or a "cure" (Gompertz) model. The default is "canonical"; if this
results in extremely large scale and/or shape estimates, consider trying
"rate".</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>a list with components <code>eps</code> (convergence criterion),
<code>maxiter</code> (maximum number of iterations), and <code>silent</code> (logical,
controlling amount of output).  You can change any component without mention
the other(s).</p></td>
    </tr>
    <tr>
      <th>singular.ok</th>
      <td><p>Not used.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>Not used.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Return the design matrix in the model object?</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Return the response in the model object?</p></td>
    </tr>
    <tr>
      <th>center</th>
      <td><p>Logical, only affects plotting. Results are reported as is,
without centering. See Details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code><a href='https://rdrr.io/r/base/c.html'>c("phreg", "coxreg")</a></code> with components</p>
<dt>coefficients</dt><dd><p>Fitted parameter estimates.</p></dd> <dt>cuts</dt><dd><p>Cut points for
the "pch" distribution. <code>NULL</code> otherwise.</p></dd> <dt>hazards</dt><dd><p>The estimated
constant levels in the case of the "pch" distribution. <code>NULL</code>
otherwise.</p></dd> <dt>var</dt><dd><p>Covariance matrix of the estimates.</p></dd>
<dt>loglik</dt><dd><p>Vector of length two; first component is the value at the
initial parameter values, the second componet is the maximized value.</p></dd>
<dt>score</dt><dd><p>The score test statistic (at the initial value).</p></dd>
<dt>linear.predictors</dt><dd><p>The estimated linear predictors.</p></dd>
<dt>means</dt><dd><p>Means of the columns of the design matrix, except those columns
corresponding to a factor level, if <code>center = TRUE</code>. Otherwise all
zero.</p></dd> <dt>w.means</dt><dd><p>Weighted (against exposure time) means of covariates;
weighted relative frequencies of levels of factors.</p></dd> <dt>n</dt><dd><p>Number of
spells in indata (possibly after removal of cases with NA's).</p></dd>
<dt>events</dt><dd><p>Number of events in data.</p></dd> <dt>terms</dt><dd><p>Used by extractor
functions.</p></dd> <dt>assign</dt><dd><p>Used by extractor functions.</p></dd> %
<dt>wald.test</dt><dd><p>The Wald test statistic (at the initial value).</p></dd>
<dt>y</dt><dd><p>The Surv vector.</p></dd> <dt>isF</dt><dd><p>Logical vector indicating the
covariates that are factors.</p></dd> <dt>covars</dt><dd><p>The covariates.</p></dd>
<dt>ttr</dt><dd><p>Total Time at Risk.</p></dd> <dt>levels</dt><dd><p>List of levels of factors.</p></dd>
<dt>formula</dt><dd><p>The calling formula.</p></dd> <dt>call</dt><dd><p>The call.</p></dd>
<dt>method</dt><dd><p>The method.</p></dd> <dt>convergence</dt><dd><p>Did the optimization
converge?</p></dd> <dt>fail</dt><dd><p>Did the optimization fail? (Is <code>NULL</code> if not).</p></dd>
<dt>pfixed</dt><dd><p>TRUE if shape was fixed in the estimation.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The parameterization is the same as in <code><a href='coxreg.html'>coxreg</a></code> and
<code><a href='https://rdrr.io/pkg/survival/man/coxph.html'>coxph</a></code>, but different from the one used by
<code><a href='https://rdrr.io/pkg/survival/man/survreg.html'>survreg</a></code> (which is not a proportional hazards
modelling function). The model is $$S(t; a, b, \beta, z) =
S_0((t/b)^a)^{\exp((z-mean(z))\beta)}$$ where S0 is some standardized survivor
function.</p>
<p>If <code>center = TRUE</code> (default), graphs show the "baseline" distribution
at the means of (continuous) covariates, and for the reference category in
case of factors (avoiding representing "flying pigs"). If <code>center =
FALSE</code> the baseline distribution is at the value zero of all covariates. It
is usually a good idea to use <code>center = FALSE</code> in combination with
"precentering" of covariates, that is, subtracting a reference value,
ideally close to the center of the covariate distribution. In that way, the
"reference" will be the same for all subsets of the data.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The lognormal and loglogistic baseline distributions are extended to a
three-parameter family by adding a "proportionality" parameter (multiplying
the baseline hazard function). The log of the estimated parameter turns up
as '(Intercept)' in the printed output. The reason for this extension is
that the standard lognormal and loglogistic distributions are not closed
under proportional hazards.</p>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    <p>The lognormal and loglogistic distributions are included
on an experimental basis for the moment. Use with care, results may be
unreliable!</p>
<p>The gompertz distribution has an exponentially increasing hazard function
under the canonical parametrization. This may cause instability in the
convergence of the fitting algorithm in the case of near-exponential data.
It may be resolved by using <code>param = "rate"</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='coxreg.html'>coxreg</a></code>, <code><a href='check.dist.html'>check.dist</a></code>,
<code>link{aftreg}</code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>mort</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>phreg</span>(<span class='fu'>Surv</span>(<span class='no'>enter</span>, <span class='no'>exit</span>, <span class='no'>event</span>) ~ <span class='no'>ses</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mort</span>)
<span class='no'>fit</span></div><div class='output co'>#&gt; Call:
#&gt; phreg(formula = Surv(enter, exit, event) ~ ses, data = mort)
#&gt; 
#&gt; Covariate          W.mean      Coef Exp(Coef)  se(Coef)    Wald p
#&gt; ses 
#&gt;            lower    0.416     0         1           (reference)
#&gt;            upper    0.584    -0.484     0.616     0.121     0.000 
#&gt; 
#&gt; log(scale)                    3.603               0.071     0.000 
#&gt; log(shape)                    0.331               0.058     0.000 
#&gt; 
#&gt; Events                    276 
#&gt; Total time at risk         17038 
#&gt; Max. log. likelihood      -1391.3 
#&gt; LR test statistic         16.13 
#&gt; Degrees of freedom        1 
#&gt; Overall p-value           5.91578e-05</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='phreg-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>fit.cr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='coxreg.html'>coxreg</a></span>(<span class='fu'>Surv</span>(<span class='no'>enter</span>, <span class='no'>exit</span>, <span class='no'>event</span>) ~ <span class='no'>ses</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mort</span>)
<span class='fu'><a href='check.dist.html'>check.dist</a></span>(<span class='no'>fit.cr</span>, <span class='no'>fit</span>)</div><div class='img'><img src='phreg-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Göran Broström.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


