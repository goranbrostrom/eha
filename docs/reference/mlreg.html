<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ML proportional hazards regression — mlreg • eha</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="ML proportional hazards regression — mlreg" />
<meta property="og:description" content="Maximum Likelihood estimation of proportional hazards models. Is deprecated,
use coxreg instead." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.8.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/eha.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/goranbrostrom/eha/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>ML proportional hazards regression</h1>
    <small class="dont-index">Source: <a href='https://github.com/goranbrostrom/eha/blob/master/R/mlreg.R'><code>R/mlreg.R</code></a></small>
    <div class="hidden name"><code>mlreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Maximum Likelihood estimation of proportional hazards models. Is deprecated,
use <code>coxreg</code> instead.</p>
    </div>

    <pre class="usage"><span class='fu'>mlreg</span>(
  <span class='kw'>formula</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/formula.html'>formula</a></span>(<span class='no'>data</span>),
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame</a></span>(),
  <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"na.action"</span>),
  <span class='kw'>init</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"ML"</span>, <span class='st'>"MPPL"</span>),
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>eps</span> <span class='kw'>=</span> <span class='fl'>1e-08</span>, <span class='kw'>maxiter</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>n.points</span> <span class='kw'>=</span> <span class='fl'>12</span>, <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>),
  <span class='kw'>singular.ok</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>model</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>center</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>y</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>boot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>geometric</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>rs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>frailty</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>max.survs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a formula object, with the response on the left of a ~
operator, and the terms on the right. The response must be a survival object
as returned by the Surv function.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a data.frame in which to interpret the variables named in the
formula.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a missing-data filter function, applied to the model.frame,
after any subset argument has been used.  Default is
<code>options()$na.action</code>.</p></td>
    </tr>
    <tr>
      <th>init</th>
      <td><p>vector of initial values of the iteration.  Default initial
value is zero for all variables.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Method of treating ties, "ML", the default, means pure maximum
likelihood, i.e, data are treated as discrete. The choice "MPPL" implies
that risk sets with no tied events are treated as in ordinary Cox
regression. This is a cameleont that adapts to data, part discrete and part
continuous.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>a list with components <code>eps</code> (convergence criterion),
<code>maxiter</code> (maximum number of iterations), and <code>silent</code> (logical,
controlling amount of output). You can change any component without mention
the other(s).</p></td>
    </tr>
    <tr>
      <th>singular.ok</th>
      <td><p>Not used.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>Not used.</p></td>
    </tr>
    <tr>
      <th>center</th>
      <td><p>Should covariates be centered? Default is TRUE</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Return the design matrix in the model object?</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>return the response in the model object?</p></td>
    </tr>
    <tr>
      <th>boot</th>
      <td><p>No. of bootstrap replicates. Defaults to FALSE, i.e., no
bootstrapping.</p></td>
    </tr>
    <tr>
      <th>geometric</th>
      <td><p>If <code>TRUE</code>, the intensity is assumed constant within
strata.</p></td>
    </tr>
    <tr>
      <th>rs</th>
      <td><p>Risk set? If present, speeds up calculations considerably.</p></td>
    </tr>
    <tr>
      <th>frailty</th>
      <td><p>A grouping variable for frailty analysis. Full name is
needed.</p></td>
    </tr>
    <tr>
      <th>max.survs</th>
      <td><p>Sampling of risk sets?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code><a href='https://rdrr.io/r/base/c.html'>c("mlreg", "coxreg", "coxph")</a></code> with components</p>
<dt>coefficients</dt><dd><p>Fitted parameter estimates.</p></dd> <dt>var</dt><dd><p>Covariance
matrix of the estimates.</p></dd> <dt>loglik</dt><dd><p>Vector of length two; first
component is the value at the initial parameter values, the second componet
is the maximized value.</p></dd> <dt>score</dt><dd><p>The score test statistic (at the
initial value).</p></dd> <dt>linear.predictors</dt><dd><p>The estimated linear predictors.</p></dd>
<dt>residuals</dt><dd><p>The martingale residuals.</p></dd> <dt>hazard</dt><dd><p>The estimated
baseline hazard.</p></dd> <dt>means</dt><dd><p>Means of the columns of the design matrix.</p></dd>
<dt>w.means</dt><dd><p>Weighted (against exposure time) means of covariates;
weighted relative frequencies of levels of factors.</p></dd> <dt>n</dt><dd><p>Number of
spells in indata (possibly after removal of cases with NA's).</p></dd>
<dt>events</dt><dd><p>Number of events in data.</p></dd> <dt>terms</dt><dd><p>Used by extractor
functions.</p></dd> <dt>assign</dt><dd><p>Used by extractor functions.</p></dd> <dt>wald.test</dt><dd><p>The
Walt test statistic (at the initial value).</p></dd> <dt>y</dt><dd><p>The Surv vector.</p></dd>
<dt>isF</dt><dd><p>Logical vector indicating the covariates that are factors.</p></dd>
<dt>covars</dt><dd><p>The covariates.</p></dd> <dt>ttr</dt><dd><p>Total Time at Risk.</p></dd>
<dt>levels</dt><dd><p>List of levels of factors.</p></dd> <dt>formula</dt><dd><p>The calling
formula.</p></dd> <dt>call</dt><dd><p>The call.</p></dd> <dt>bootstrap</dt><dd><p>The bootstrap sample, if
requested on input.</p></dd> <dt>sigma</dt><dd><p>Present if a frailty model is fitted.
Equals the estimated frailty standard deviation.</p></dd> <dt>sigma.sd</dt><dd><p>The
standard error of the estimated frailty standard deviation.</p></dd>
<dt>method</dt><dd><p>The method.</p></dd> <dt>convergence</dt><dd><p>Did the optimization
converge?</p></dd> <dt>fail</dt><dd><p>Did the optimization fail? (Is <code>NULL</code> if not).</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Method <code>ML</code> performs a true discrete analysis, i.e., one parameter per
observed event time. Method <code>MPPL</code> is a compromize between the discrete
and continuous time approaches; one parameter per observed event time with
multiple events. With no ties in data, an ordinary Cox regression (as with
<code><a href='coxreg.html'>coxreg</a></code>) is performed.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function starts by creating risksets, if no riskset is supplied
via <code>rs</code>, with the aid of <code><a href='risksets.html'>risksets</a></code>. This latter mechanism
fails if there are any NA's in the data! Note also that it depends on
stratification, so <code>rs</code> contains information about stratification.
Giving another strata variable in the formula is an error. The same is ok,
for instance to supply stratum interactions.</p>
<p>Note futher that <code>mlreg</code> is deprecated. <code><a href='coxreg.html'>coxreg</a></code> should be
used instead.</p>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    <p>The use of <code>rs</code> is dangerous, see note above. It can
however speed up computing time.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Broström, G. (2002). Cox regression; Ties without
tears. <em>Communications in Statistics: Theory and Methods</em> <b>31</b>,
285--297.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='coxreg.html'>coxreg</a></code>, <code><a href='risksets.html'>risksets</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>

 <span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>time</span><span class='kw'>=</span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>, <span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>3</span>),
                <span class='kw'>status</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>),
                <span class='kw'>x</span><span class='kw'>=</span>     <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>),
                <span class='kw'>sex</span><span class='kw'>=</span>   <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>))
 <span class='fu'>mlreg</span>( <span class='fu'>Surv</span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>x</span> + <span class='fu'>strata</span>(<span class='no'>sex</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>) <span class='co'>#stratified model</span></div><div class='output co'>#&gt; [1] "'mlreg' is deprecated; use 'coxreg' instead (see 'methods')"</div><div class='input'> <span class='co'># Same as:</span>
 <span class='no'>rs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='risksets.html'>risksets</a></span>(<span class='fu'>Surv</span>(<span class='no'>dat</span>$<span class='no'>time</span>, <span class='no'>dat</span>$<span class='no'>status</span>), <span class='kw'>strata</span> <span class='kw'>=</span> <span class='no'>dat</span>$<span class='no'>sex</span>)</div><div class='output co'>#&gt; <span class='error'>Error in list(ns = ns, antrs = counts$antrs, risktimes = counts$risktimes,     n.events = counts$n.events, size = counts$size, ): argument 6 is empty</span></div><div class='input'> <span class='fu'>mlreg</span>( <span class='fu'>Surv</span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>x</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>rs</span> <span class='kw'>=</span> <span class='no'>rs</span>) <span class='co'>#stratified model</span></div><div class='output co'>#&gt; [1] "'mlreg' is deprecated; use 'coxreg' instead (see 'methods')"</div><div class='input'> 
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Göran Broström.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


